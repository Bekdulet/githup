<!doctype html>
<html lang="kk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WEB-–±–µ—Ç - “ö–æ–ª–¥–∞—É –æ—Ä—Ç–∞–ª—ã“ì—ã</title>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: Arial, sans-serif;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        position: relative;
        overflow-x: hidden;
      }

      /* –í–ò–î–ï–û –§–û–ù–û–í–û–ï */
      body::before {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        z-index: -2;
      }

      video#background-video {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1;
      }

      /* –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Å–ª–æ–π –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ */
      body::after {
        content: '';
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.4);
        z-index: -1;
      }

      .container {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        max-width: 900px;
        text-align: center;
        position: relative;
        z-index: 10;
      }

      .header {
        margin-bottom: 30px;
      }

      .logo {
        font-size: 3rem;
        margin-bottom: 10px;
      }

      h1 {
        font-size: 2.5rem;
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .subtitle {
        font-size: 1.2rem;
        color: #7f8c8d;
        margin-bottom: 40px;
      }

      .cards-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 30px;
        margin-top: 30px;
      }

      .card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 15px;
        padding: 30px;
        cursor: pointer;
        transition: all 0.3s ease;
        text-decoration: none;
        color: #fff;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        border: 3px solid transparent;
      }

      .card:hover {
        transform: translateY(-10px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        border-color: #fff;
      }

      .card.parents {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }

      .card.parents:hover {
        background: linear-gradient(135deg, #f5576c 0%, #f093fb 100%);
      }

      .card.kids-autism {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      }

      .card.kids-autism:hover {
        background: linear-gradient(135deg, #00f2fe 0%, #4facfe 100%);
      }

      .card.kids-disability {
        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      }

      .card.kids-disability:hover {
        background: linear-gradient(135deg, #38f9d7 0%, #43e97b 100%);
      }

      .card-icon {
        font-size: 3rem;
        margin-bottom: 15px;
      }

      .card h2 {
        font-size: 1.5rem;
        margin-bottom: 10px;
      }

      .card p {
        font-size: 0.95rem;
        opacity: 0.95;
      }

      .info-box {
        background: #ecf0f1;
        border-left: 4px solid #667eea;
        padding: 15px;
        margin-top: 30px;
        border-radius: 5px;
        text-align: left;
      }

      .info-box h3 {
        color: #2c3e50;
        margin-bottom: 10px;
      }

      .info-box p {
        color: #555;
        line-height: 1.6;
      }

      /* Chat widget styling */
      .chat-toggle {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        background: #667eea;
        color: #fff;
        border-radius: 50%;
        font-size: 1.8rem;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 1000;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      }

      .chat-section {
        position: fixed;
        bottom: 80px;
        right: 20px;
        width: 300px;
        max-height: 400px;
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        display: none;
        flex-direction: column;
        padding: 10px;
        font-size: 0.9rem;
        z-index: 999;
      }
      .chat-section.visible {
        display: flex;
      }
      .chat-window {
        flex: 1;
        border: 1px solid #ccc;
        padding: 8px;
        overflow-y: auto;
        background: #f9f9f9;
        border-radius: 6px;
        margin-bottom: 6px;
        font-size: 0.85rem;
      }
      .chat-msg {
        margin-bottom: 6px;
      }
      .chat-controls {
        display: flex;
        gap: 4px;
      }
      .chat-controls textarea {
        flex: 1;
        resize: vertical;
        min-height: 30px;
        font-size: 0.9rem;
      }
      .chat-controls button {
        padding: 6px 8px;
        font-size: 0.9rem;
        cursor: pointer;
      }

      @media (max-width: 768px) {
        .container {
          padding: 20px;
        }

        h1 {
          font-size: 1.8rem;
        }

        .cards-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <!-- –í–ò–î–ï–û –§–û–ù–û–í–û–ï -->
    <video id="background-video" autoplay muted loop>
      <source src="generated_video (1).mp4" type="video/mp4">
      <!-- –†–µ–∑–µ—Ä–≤–Ω—ã–π —Ñ–æ–Ω –µ—Å–ª–∏ –≤–∏–¥–µ–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
    </video>

    <!-- chat toggle icon (opens Gemini chat panel) -->
    <div id="chat-toggle" class="chat-toggle" title="Gemini —Å”©–π–ª–µ—Å—É">üí¨</div>

    <div class="container">
      <div class="header">
        <div class="logo">üåê</div>
        <h1>SANA</h1>
        <p class="subtitle">“ö–æ–ª–¥–∞—É –∂”ô–Ω–µ –æ“õ—ã—Ç—É –æ—Ä—Ç–∞–ª—ã“ì—ã</p>
      </div>

      <p style="font-size: 1.1rem; color: #555; margin-bottom: 30px">
        –ñ–µ–∫–µ –∞“õ–ø–∞—Ä–∞—Ç –∞–ª—É “Ø—à—ñ–Ω ”©–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏—è“£—ã–∑–¥—ã —Ç–∞“£–¥–∞“£—ã–∑
      </p>

      <div class="cards-grid">
        <!-- –†–û–î–ò–¢–ï–õ–ò -->
        <a href="parents.html" class="card parents">
          <div class="card-icon">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
          <h2>–ê—Ç–∞‚Äë–∞–Ω–∞–ª–∞—Ä “Ø—à—ñ–Ω</h2>
          <p>
            –ë–∞–ª–∞“£—ã–∑–¥—ã “õ–∞–ª–∞–π “õ–æ–ª–¥–∞–ø, –¥–∞–º—ã—Ç—ã–ø –∂–∞—Ç“õ–∞–Ω—ã“£—ã–∑–¥—ã –±—ñ–ª—ñ“£—ñ–∑. –ö“Ø—Ç—ñ–º–≥–µ
            –ø—Ä–∞–∫—Ç–∏–∫–∞–ª—ã“õ –∫–µ“£–µ—Å—Ç–µ—Ä –º–µ–Ω “±—Å—ã–Ω—ã—Å—Ç–∞—Ä.
          </p>
        </a>

        <!-- –î–ï–¢–ò –° –ê–£–¢–ò–ó–ú–û–ú -->
        <a href="kids-autism.html" class="card kids-autism">
          <div class="card-icon">üß©</div>
          <h2>–ê—É—Ç–∏–∑–º—ñ –±–∞—Ä –±–∞–ª–∞–ª–∞—Ä“ì–∞</h2>
          <p>
            –ñ–∞—Ä—ã“õ —Å—É—Ä–µ—Ç—Ç–µ—Ä, “õ–∞—Ä–∞–ø–∞–π—ã–º –≤–∏–¥–µ–æ–ª–∞—Ä –∂”ô–Ω–µ —Ç“Ø—Å—ñ–Ω—ñ–∫—Ç—ñ –Ω“±—Å“õ–∞—É–ª—ã“õ—Ç–∞—Ä.
            –ë–∞—Ä–ª—ã“ì—ã “õ–∞–±—ã–ª–¥–∞—É“ì–∞ —ã“£“ì–∞–π–ª—ã –µ—Ç—ñ–ø –±–µ–π—ñ–º–¥–µ–ª–≥–µ–Ω.
          </p>
        </a>

        <!-- –î–ï–¢–ò –° –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø–ú–ò -->
        <a href="kids-disability.html" class="card kids-disability">
          <div class="card-icon">‚ôø</div>
          <h2>–ú“Ø–≥–µ–¥–µ–∫—Ç—ñ–≥—ñ –±–∞—Ä –±–∞–ª–∞–ª–∞—Ä“ì–∞</h2>
          <p>
            “Æ–ª–∫–µ–Ω “õ–∞—Ä—ñ–ø–ø–µ–Ω, –∞–π“õ—ã–Ω “õ“±—Ä—ã–ª—ã–º–º–µ–Ω –∂”ô–Ω–µ —ã“£“ì–∞–π–ª—ã –Ω–∞–≤–∏–≥–∞—Ü–∏—è–º–µ–Ω
            –±–µ–π—ñ–º–¥–µ–ª–≥–µ–Ω –º–∞–∑–º“±–Ω.
          </p>
        </a>
      </div>

      <div class="info-box">
        <h3>üìå WEB-–±–µ—Ç –∂–æ–±–∞—Å—ã —Ç—É—Ä–∞–ª—ã</h3>
        <p>
          WEB-–±–µ—Ç –æ—Ä—Ç–∞–ª—ã“ì—ã –¥–∞–º—É –µ—Ä–µ–∫—à–µ–ª—ñ–∫—Ç–µ—Ä—ñ –±–∞—Ä –∞—Ç–∞-–∞–Ω–∞–ª–∞—Ä –º–µ–Ω –±–∞–ª–∞–ª–∞—Ä“ì–∞
          “õ–æ–ª–¥–∞—É –∫”©—Ä—Å–µ—Ç—É “Ø—à—ñ–Ω “õ“±—Ä—ã–ª“ì–∞–Ω. –ë—ñ–∑ –∂–∞–π–ª—ã –∂”ô–Ω–µ “õ–æ–ª–¥–∞—É—à—ã –æ—Ä—Ç–∞ –∂–∞—Å–∞—É“ì–∞
          –ø–∞–π–¥–∞–ª—ã –∞“õ–ø–∞—Ä–∞—Ç, –∫–µ“£–µ—Å—Ç–µ—Ä –º–µ–Ω —Ä–µ—Å—É—Ä—Å—Ç–∞—Ä “±—Å—ã–Ω–µ–º—ñ–∑.
        </p>
      </div>

      <!-- Gemini —Å”©–π–ª–µ—Å—É –ø–µ–Ω –¥–∞—É—ã—Å—Ç—ã“õ –±–∞—Å“õ–∞—Ä—É -->
      <div class="chat-section" id="chat-section">
        <h2>Gemini —Å”©–π–ª–µ—Å—É</h2>
        <div id="chat-window" class="chat-window"></div>
        <div class="chat-controls">
          <textarea id="chat-input" placeholder="–•–∞–±–∞—Ä–ª–∞–º–∞ –∂–∞–∑..."></textarea>
          <button id="send-btn">–ñ—ñ–±–µ—Ä—É</button>
          <button id="voice-btn">üé§</button>
        </div>
      </div>
    </div>

    <script>
      // –¥–∞—É—ã—Å –∞—Ä“õ—ã–ª—ã –µ–Ω–≥—ñ–∑—É –º“Ø–º–∫—ñ–Ω–¥—ñ–≥—ñ –±–∞—Ä —á–∞—Ç—Ç—ã“£ “õ–∞—Ä–∞–ø–∞–π—ã–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è—Å—ã
      const chatWindow = document.getElementById("chat-window");
      const input = document.getElementById("chat-input");
      const sendBtn = document.getElementById("send-btn");
      const voiceBtn = document.getElementById("voice-btn");
      const chatToggle = document.getElementById("chat-toggle");
      const chatSection = document.getElementById("chat-section");

      // toggle visibility when icon clicked
      chatToggle.addEventListener("click", () => {
        chatSection.classList.toggle("visible");
        if (chatSection.classList.contains("visible")) {
          input.focus();
        }
      });

      function appendMessage(sender, msg) {
        const msgEl = document.createElement("div");
        msgEl.className = "chat-msg";
        msgEl.innerHTML = `<strong>${sender}:</strong> ${msg}`;
        chatWindow.appendChild(msgEl);
        chatWindow.scrollTop = chatWindow.scrollHeight;
      }

      async function sendMessage(text) {
        appendMessage("–°—ñ–∑", text);
        input.value = "";
        try {
          let apiUrl = "/api/gemini";
          if (window.location.port && window.location.port !== "3000") {
            console.warn("using backend on port 3000, not current origin");
            apiUrl = "http://localhost:3000/api/gemini";
          }

          const resp = await fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ message: text }),
          });
          let data = {};
          if (resp.ok) {
            try {
              data = await resp.json();
            } catch (parseErr) {
              console.warn("JSON parse failed:", parseErr);
            }
          } else {
            const text = await resp.text();
            console.warn("Non-OK status from /api/gemini:", resp.status, text);
            appendMessage("Gemini", `–°–µ—Ä–≤–µ—Ä “õ–∞—Ç–µ ${resp.status}`);
            return;
          }
          if (data.error) {
            appendMessage("Gemini", `–°–µ—Ä–≤–µ—Ä: ${data.error}`);
          } else {
            appendMessage(
              "Gemini",
              data.reply || "–ñ–∞—É–∞–ø –∂–æ“õ (—Å–µ—Ä–≤–µ—Ä –∂–∞—É–∞–ø –±–µ—Ä–º–µ–¥—ñ)",
            );
            if (!data.reply) console.warn("empty reply from backend", data);
          }
        } catch (err) {
          const msg = err.message || String(err);
          appendMessage(
            "Gemini",
            "“ö–∞—Ç–µ: " +
              msg +
              ".\n–°–µ—Ä–≤–µ—Ä —ñ—Å–∫–µ “õ–æ—Å—ã–ª“ì–∞–Ω—ã–Ω –∂”ô–Ω–µ –ø–æ—Ä—Ç 3000-–¥–µ –∂“±–º—ã—Å —ñ—Å—Ç–µ–π—Ç—ñ–Ω—ñ–Ω —Ç–µ–∫—Å–µ—Ä—ñ“£—ñ–∑.",
          );
          console.error("sendMessage failed", err);
        }
      }

      sendBtn.addEventListener("click", () => {
        if (input.value.trim()) sendMessage(input.value.trim());
      });

      input.addEventListener("keydown", (e) => {
        if (e.key === "Enter" && !e.shiftKey) {
          e.preventDefault();
          if (input.value.trim()) sendMessage(input.value.trim());
        }
      });

      // voice recognition
      if ("webkitSpeechRecognition" in window || "SpeechRecognition" in window) {
        const SpeechRecognition =
          window.SpeechRecognition || window.webkitSpeechRecognition;
        const recognition = new SpeechRecognition();

        recognition.continuous = true;
        recognition.lang = "kk-KZ";
        recognition.interimResults = false;

        const WAKE_WORDS = ["—ç–π –±–æ—Ç", "—ç–π –≥–º–µ–Ω–∏", "–±–æ—Ç", "—Å–∞–Ω–∞"];

        function handleTranscript(text) {
          const lower = text.toLowerCase();
          const containsWake = WAKE_WORDS.some((w) => lower.includes(w));
          if (containsWake) {
            if (!chatSection.classList.contains("visible")) {
              chatSection.classList.add("visible");
            }
            let cleaned = lower;
            WAKE_WORDS.forEach((w) => {
              cleaned = cleaned.replace(w, "");
            });
            cleaned = cleaned.trim();
            if (cleaned) sendMessage(cleaned);
          } else if (chatSection.classList.contains("visible")) {
            sendMessage(text);
          }
        }

        voiceBtn.addEventListener("click", () => {
          recognition.start();
        });

        recognition.addEventListener("result", (e) => {
          const transcript = e.results[e.results.length - 1][0].transcript;
          handleTranscript(transcript);
        });

        recognition.addEventListener("end", () => {
          recognition.start();
        });
      } else {
        voiceBtn.disabled = true;
        voiceBtn.title = "“ö“±—Ä—ã–ª“ì—ã–¥–∞ –¥–∞—É—ã—Å —Ç–∞–Ω—É –∂–æ“õ";
      }
    </script>
  </body>
</html>